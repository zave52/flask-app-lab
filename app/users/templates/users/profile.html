{% extends "base.html" %}

{% block title %}Профіль користувача{% endblock %}

{% block content %}
  <div class="profile-container profile-{{ theme }}">
    <h2>Вітаємо, {{ username }}!</h2>

    <div class="profile-info">
      <p><strong>Ім'я користувача:</strong> {{ username }}</p>
      <p><strong>Статус:</strong> Авторизований</p>
    </div>

    <div class="theme-selector">
      <h4>Кольорова схема:</h4>
      <div class="theme-buttons">
        <a href="{{ url_for('users_bp.set_theme', theme='light') }}"
           class="theme-btn theme-btn-light {% if theme == 'light' %}active{% endif %}">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
               stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="5"></circle>
            <line x1="12" y1="1" x2="12" y2="3"></line>
            <line x1="12" y1="21" x2="12" y2="23"></line>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
            <line x1="1" y1="12" x2="3" y2="12"></line>
            <line x1="21" y1="12" x2="23" y2="12"></line>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
          </svg>
          Світла
        </a>
        <a href="{{ url_for('users_bp.set_theme', theme='dark') }}"
           class="theme-btn theme-btn-dark {% if theme == 'dark' %}active{% endif %}">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
               stroke="currentColor" stroke-width="2">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
          </svg>
          Темна
        </a>
      </div>
    </div>

    <form method="POST" action="{{ url_for('users_bp.logout') }}">
      <button type="submit" class="logout-btn">Вийти</button>
    </form>

    <div class="cookies-section">
      <h3>Управління Cookies</h3>

      <div class="cookie-form-container">
        <h4>Додати Cookie</h4>
        <form method="POST" action="{{ url_for('users_bp.add_cookie') }}" class="cookie-form">
          <div class="form-row">
            <div class="form-group">
              <label for="cookie_key">Ключ:</label>
              <input type="text" id="cookie_key" name="cookie_key" class="input-field" required
                     placeholder="Наприклад: theme">
            </div>

            <div class="form-group">
              <label for="cookie_value">Значення:</label>
              <input type="text" id="cookie_value" name="cookie_value" class="input-field" required
                     placeholder="Наприклад: dark">
            </div>

            <div class="form-group">
              <label for="cookie_max_age">Термін дії (секунди):</label>
              <input type="number" id="cookie_max_age" name="cookie_max_age" class="input-field"
                     placeholder="За замовчуванням: 3600">
            </div>
          </div>

          <button type="submit" class="submit-btn">Додати Cookie</button>
        </form>
      </div>

      <div class="cookie-delete-container">
        <h4>Видалити Cookie</h4>
        <div class="delete-buttons">
          <form method="POST" action="{{ url_for('users_bp.delete_all_cookies') }}" style="display: inline;">
            <button type="submit" class="delete-all-btn"
                    onclick="return confirm('Ви впевнені, що хочете видалити всі cookies?')">
              Видалити всі Cookies
            </button>
          </form>

          <form method="POST" action="{{ url_for('users_bp.delete_cookie') }}" class="delete-single-form">
            <div class="form-inline">
              <input type="text" name="cookie_key" class="input-field" placeholder="Ключ cookie для видалення" required>
              <button type="submit" class="delete-btn">Видалити</button>
            </div>
          </form>
        </div>
      </div>

      <div class="cookies-table-container">
        <h4>Поточні Cookies</h4>
        {% if cookies %}
          <table class="cookies-table">
            <thead>
            <tr>
              <th>Ключ</th>
              <th>Значення</th>
              <th>Дія</th>
            </tr>
            </thead>
            <tbody>
            {% for key, value in cookies.items() %}
              <tr>
                <td><strong>{{ key }}</strong></td>
                <td>{{ value }}</td>
                <td>
                  <form method="POST" action="{{ url_for('users_bp.delete_cookie') }}" style="display: inline;">
                    <input type="hidden" name="cookie_key" value="{{ key }}">
                    <button type="submit" class="table-delete-btn">Видалити</button>
                  </form>
                </td>
              </tr>
            {% endfor %}
            </tbody>
          </table>
        {% else %}
          <p class="no-cookies">Немає збережених cookies</p>
        {% endif %}
      </div>
    </div>

    <nav class="greeting-nav" style="margin-top: 30px;">
      <ul>
        <li>
          <a href="{{ url_for('products_bp.get_products') }}">Переглянути продукти</a>
        </li>
        <li>
          <a href="{{ url_for('users_bp.greetings', name=username) }}">Привітання</a>
        </li>
      </ul>
    </nav>
  </div>
{% endblock %}
